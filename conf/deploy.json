{
  "defaultStacks": ["membership"],
  "packages": {
    "ami-update": {
       "type": "ami-cloudformation-parameter",
       "apps": [
         "memsub-promotions"
       ],
       "data": {
         "amiTags": {
           "Recipe": "xenial-membership",
           "AmigoStage": "PROD"
         },
        "amiParameter": "AmiId",
        "cloudFormationStackByTags": true
      }
    },
    "memsub-promotions": {
      "type":"autoscaling",
      "data": {
        "port": "9000",
        "bucket": "gu-promotions-tool-dist"
      }
    }
  },
  "recipes": {
    "default" : {
      "depends" : [
        "uploadArtifacts",
        "deploy"
      ]
    },
    "uploadArtifacts": {
      "actionsBeforeApp": ["ami-update.update","memsub-promotions.uploadArtifacts"]
    },
    "deploy": {
      "actionsPerHost": [
        "memsub-promotions.deploy"
      ]
    }
  }
}
